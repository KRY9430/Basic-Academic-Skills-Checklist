
<!DOCTYPE html>
<html lang="ko">
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js">
</script>
<meta charset="UTF-8">
<title>문해력 향상 점검 도구</title>
<style>
.tooltip { position: relative; display: inline-block; cursor: help; }
.tooltip .tooltiptext { visibility: hidden; width: 400px; background: #f9f9f9; color: #000; border: 1px solid #ccc; padding: 8px; border-radius: 4px; position: absolute; z-index: 1; top: 100%; left: 0; white-space: pre-line; }
.tooltip:hover .tooltiptext { visibility: visible; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
th { background: #f2f2f2; }
.control-panel { margin: 10px 0; }
th:nth-child(1), td:nth-child(1) {
  width: 80px;           /* 좁은 너비 */
  white-space: normal;   /* 줄바꿈 허용 */
  word-break: keep-all;  /* 단어 중간에서 줄바꿈 안 함 (띄어쓰기 기준으로만 줄바꿈) */
}th:nth-child(2), td:nth-child(2) {
  width: 80px;           /* 좁은 너비 */
  white-space: normal;   /* 줄바꿈 허용 */
  word-break: keep-all;  /* 단어 중간에서 줄바꿈 안 함 (띄어쓰기 기준으로만 줄바꿈) */
}
th:nth-child(3), td:nth-child(3) {
  width: 80px;           /* 좁은 너비 */
  white-space: normal;   /* 줄바꿈 허용 */
  word-break: keep-all;  /* 단어 중간에서 줄바꿈 안 함 (띄어쓰기 기준으로만 줄바꿈) */
}
th:nth-child(4), td:nth-child(4) {
  width: 60%;
  min-width: 280px;
  text-align: left;
}
th:nth-child(7), td:nth-child(7) {
  width: 200px;         /* 너비 고정 또는 적당히 좁게 */
  max-width: 400px;
  white-space: nowrap;  /* 줄바꿈 방지 */
}
</style>
</head>
<body>
<h2>문해력 향상 점검 도구</h2>
<div class="control-panel">
학년군:
<label><input type="checkbox" class="gradeFilter" value="1~2" checked> 1~2학년군</label>
<label><input type="checkbox" class="gradeFilter" value="3~4" checked> 3~4학년군</label>
<label><input type="checkbox" class="gradeFilter" value="5~6" checked> 5~6학년군</label>
<button onclick="applyFilter()">적용</button>
<button onclick="resetFilter()">초기화</button>
</div>
<table id="checklistTable">
   <thead>
    <tr>
     <th colspan="1" rowspan="2">
      영역
     </th>
     <th colspan="1" rowspan="2">
      하위 요소
     </th>
     <th colspan="1" rowspan="2">
      학년군
     </th>
     <th colspan="1" rowspan="2">
      점검 항목
     </th>
     <th colspan="2" rowspan="1">
      도달 여부
     </th>
     <th colspan="1" rowspan="2">
      평정 근거
     </th>
    </tr>
    <tr>
     <th>
      미도달
     </th>
     <th>
      도달
     </th>
    </tr>
   </thead><tbody id="tableBody">
</tbody>
</table>
<div style="margin-top:10px;">
<button onclick="exportExcel()">엑셀로 저장</button>
</div>
<script>
let previousStates = {};
const data = [
{'영역': '듣기․말하기',
  '하위 요소': '소리 식별하기',
  '학년군': '1~2',
  '점검 항목': '▪  여러 가지 소리를 듣고 구별할 수 있다.',
  '세부 점검 요소': '- /ㄱ/, /ㄲ/, /ㅋ/ 소리를 구별하여 인식하는가?<br>- 소리를 듣고 음절 수를 인식하는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '1~2',
  '점검 항목': '▪  (다른 사람의 말/이야기)를 들을 때 주의를 집중할 수 있다.',
  '세부 점검 요소': '- 말하는 사람을 바라보며 집중하는 태도를 보이는가?<br>- 불필요한 행동 없이 듣는 데 주의를 기울이는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '1~2',
  '점검 항목': '▪  (다른 사람의 말/이야기)를 듣고 대강의 내용을 파악할 수 있다.',
  '세부 점검 요소': '- 중요한 내용을 중심으로 줄거리를 말할 수 있는가?<br>- 들은 내용을 간단히 정리하여 설명할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  (안내하는 말/이야기)를 듣고 주제를 파악할 수 있다.',
  '세부 점검 요소': '- 안내의 중심 내용을 말할 수 있는가?<br>- 안내의 목적을 이해하고 설명할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  (안내하는 말/이야기)를 듣고 중요한 내용을 이해할 수 있다.',
  '세부 점검 요소': '- 안내에서 꼭 필요한 정보를 기억하고 활용하는가?<br>- 안내의 핵심 지시사항을 따라 할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (설명하는 말/설득하는 말/이야기)를 듣고 주제를 파악할 수 있다.',
  '세부 점검 요소': '- 설명이나 설득에서 다루는 핵심 주제를 말할 수 있는가?<br>- 주제와 세부 사항을 구별할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (설명하는 말/설득하는 말/이야기)를 듣고 중요한 내용을 이해할 수 있다.',
  '세부 점검 요소': '- 설명이나 설득에서 제시된 핵심 근거를 이해하는가?<br>- 중요 정보와 세부 정보를 구분할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (설명하는 말/설득하는 말/이야기)를 듣고 중요한 내용을 요약할 수 있다.',
  '세부 점검 요소': '- 말한 내용을 불필요한 부분은 빼고 핵심만 정리하는가?<br>- 요약된 말이 원래 말의 뜻과 크게 다르지 않은가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (다른 사람의 말/이야기)를 듣고 이어질 내용을 예측할 수 있다.',
  '세부 점검 요소': '- 지금까지의 내용을 바탕으로 이어질 사건이나 말을 추측하는가?<br>- 예측이 전체 맥락과 자연스럽게 연결되는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (다른 사람의 말/이야기)를 듣고 말하는 이의 의도를 추측할 수 있다.',
  '세부 점검 요소': '- 말하는 사람의 표정·말투·내용을 통해 의도를 짐작하는가?<br>- 말의 겉뜻과 속뜻을 구별할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 확인·추론·평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  (설명하는 말/설득하는 말/이야기)를 듣고 드러나지 않거나 생략된 내용을 추측할 수 있다.',
  '세부 점검 요소': '- 생략된 정보를 상황이나 맥락을 통해 추론하는가?<br>- 직접적으로 드러나지 않은 의미를 파악할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  상황이나 상대에 알맞은 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '- 상대의 나이·관계·상황에 맞는 말을 생각할 수 있는가?<br>- 상황(놀이, 수업, 가정 등)에 맞는 말을 떠올릴 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '- 사건의 처음·중간·끝을 구분하여 순서대로 정리할 수 있는가?<br>- 잘못된 순서를 스스로 고쳐 다시 배열할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '- 사건의 처음·중간·끝을 구분하여 순서대로 정리할 수 있는가?<br>- 잘못된 순서를 스스로 고쳐 다시 배열할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '- 사건의 처음·중간·끝을 구분하여 순서대로 정리할 수 있는가?<br>- 잘못된 순서를 스스로 고쳐 다시 배열할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다.',
  '세부 점검 요소': '- 목소리 크기와 속도가 적절하여 잘 들을 수 있는가?<br>- 발표할 때 시선과 태도가 자신감 있게 드러나는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다.',
  '세부 점검 요소': '- 목소리 크기와 속도가 적절하여 잘 들을 수 있는가?<br>- 발표할 때 시선과 태도가 자신감 있게 드러나는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다.',
  '세부 점검 요소': '- 목소리 크기와 속도가 적절하여 잘 들을 수 있는가?<br>- 발표할 때 시선과 태도가 자신감 있게 드러나는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  적절한 표정, 몸짓, 말투로 표현할 수 있다.',
  '세부 점검 요소': '- 말의 내용과 표정·몸짓이 어울리는가?<br>- 말투를 조절하여 감정을 자연스럽게 드러낼 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  목적이나 청자에 알맞은 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '- 설명, 안내, 설득 등 말하기 목적에 맞는 주제를 떠올릴 수 있는가?<br>- 청자가 이해하기 쉬운 내용 요소를 선택할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  일의 원인과 결과를 고려하여 말할 내용을 구성할 수 있다. ',
  '세부 점검 요소': '- 사건의 원인과 결과를 구분하여 정리할 수 있는가?<br>- 원인과 결과를 연결해 순서대로 조직할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  비언어적･준언어적 표현을 활용하여 실감 나게 표현할 수 있다.',
  '세부 점검 요소': '- 억양·속도·강세 등을 조절하여 의미를 살릴 수 있는가?<br>- 몸짓·표정 등 비언어적 요소로 내용을 보완할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  전달하고자 하는 내용을 간결하게 표현할 수 있다.',
  '세부 점검 요소': '- 불필요한 말은 줄이고 핵심만 말할 수 있는가?<br>- 짧고 명확한 문장으로 요점을 표현할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  공식적･비공식적 상황에서 청자를 고려하여 적절한 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '- 공식적인 상황에서는 격식 있는 표현을 떠올릴 수 있는가?<br>- 비공식적 상황에서는 친근하고 자연스러운 표현을 떠올릴 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  목적에 맞게 말할 내용을 체계적으로 구성할 수 있다.',
  '세부 점검 요소': '- 도입–전개–정리의 구조로 내용을 구성할 수 있는가?<br>- 주제와 관련된 세부 내용을 빠짐없이 조직할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  비언어적･준언어적 표현의 효과를 이해하고 그 특성을 살려 실감 나게 표현할 수 있다.',
  '세부 점검 요소': '- 말의 목적에 맞게 억양·속도를 조절할 수 있는가?<br>- 표정·몸짓이 전달 효과를 높이도록 의도적으로 활용되는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  적절한 담화 표지를 사용하여 말할 수 있다.',
  '세부 점검 요소': '- ‘첫째, 다음으로, 그래서, 결국’과 같은 연결어를 사용할 수 있는가?<br>- 담화 표지를 통해 말의 흐름을 명확히 할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '내용 생성· 조직·표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  매체를 활용하여 내용을 이해하기 쉽게 표현할 수 있다.',
  '세부 점검 요소': '- 그림, 사진, PPT 등 보조 자료를 적절히 활용하는가?<br>- 매체 자료가 말의 내용을 효과적으로 보완하는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '1~2',
  '점검 항목': '▪  상대에게 반응하며 대화를 나눌 수 있다.',
  '세부 점검 요소': '- 상대의 말에 고개 끄덕이거나 반응을 보이는가?<br>- 상대의 말에 이어 자신의 생각을 적절히 덧붙이는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 듣는 이의 처지를 생각하며 칭찬, 사과의 말을 할 수 있다.',
  '세부 점검 요소': '- 상대의 상황에 맞는 칭찬·사과 표현을 사용하는가?<br>- 말하는 의도와 어휘가 적절한가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '3~4',
  '점검 항목': '▪  말차례를 지키며 대화를 나눌 수 있다.',
  '세부 점검 요소': '- 대화 중 끼어들지 않고 순서를 지키는가?<br>- 차례가 왔을 때 자연스럽게 발언하는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '3~4',
  '점검 항목': '▪  의견을 적극적으로 교환하며 회의할 수 있다.',
  '세부 점검 요소': '- 회의 주제와 관련된 의견을 적극적으로 제안하는가?<br>- 다른 사람의 의견에 근거 있는 반응을 하는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 듣는 이의 처지를 생각하며 부탁과 거절, 위로의 말을 할 수 있다.',
  '세부 점검 요소': '- 부탁할 때 정중한 표현을 사용하는가?<br>- 거절이나 위로의 말을 상황에 맞게 하는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '5~6',
  '점검 항목': '▪  의견을 제시하고 의견 불일치를 함께 조정하며 토의할 수 있다.',
  '세부 점검 요소': '- 자신의 의견을 분명히 제시하는가?<br>- 의견 차이를 조정하기 위해 타협안을 내는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '5~6',
  '점검 항목': '▪  토론의 절차와 규칙을 지키고 토론할 수 있다.',
  '세부 점검 요소': '- 발언 순서·시간 제한 등 규칙을 지키는가?<br>- 토론의 절차를 설명할 수 있는가?'},
 {'영역': '듣기․말하기',
  '하위 요소': '상호작용',
  '학년군': '5~6',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 상대가 처한 상황을 이해하고 공감할 수 있다.',
  '세부 점검 요소': '- 상대의 감정을 알아차리고 반응하는가?<br>- 공감을 표현하는 적절한 말을 사용하는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  글자, 낱말을 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 글자를 정확히 소리 낼 수 있는가?<br>- 낱말을 발음 규칙에 맞게 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '3~4',
  '점검 항목': '▪  글자, 낱말을 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 글자를 정확히 소리 낼 수 있는가?<br>- 낱말을 발음 규칙에 맞게 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '5~6',
  '점검 항목': '▪  글자, 낱말을 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 글자를 정확히 소리 낼 수 있는가?<br>- 낱말을 발음 규칙에 맞게 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  문장, 문단, 글을 정확하게 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 단위를 끊어 읽는가?<br>- 문단과 글 전체를 빠뜨리지 않고 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '3~4',
  '점검 항목': '▪  문장, 문단, 글을 정확하게 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 단위를 끊어 읽는가?<br>- 문단과 글 전체를 빠뜨리지 않고 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '5~6',
  '점검 항목': '▪  문장, 문단, 글을 정확하게 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 단위를 끊어 읽는가?<br>- 문단과 글 전체를 빠뜨리지 않고 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  의미가 잘 드러나도록 글을 알맞게 띄어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 성분에 따라 자연스럽게 끊어 읽는가?<br>- 띄어쓰기에 맞게 읽어 의미가 드러나는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '3~4',
  '점검 항목': '▪  의미가 잘 드러나도록 글을 알맞게 띄어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 성분에 따라 자연스럽게 끊어 읽는가?<br>- 띄어쓰기에 맞게 읽어 의미가 드러나는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '5~6',
  '점검 항목': '▪  의미가 잘 드러나도록 글을 알맞게 띄어 읽을 수 있다.',
  '세부 점검 요소': '- 문장 성분에 따라 자연스럽게 끊어 읽는가?<br>- 띄어쓰기에 맞게 읽어 의미가 드러나는가?'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '3~4',
  '점검 항목': '▪  글의 의미를 파악하며 유창하게 글을 읽는다. ',
  '세부 점검 요소': '- 머뭇거림 없이 적절한 속도로 읽는가?<br>- 억양과 강세를 조절하여 의미가 잘 드러나게 읽는가?'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '1~2',
  '점검 항목': '▪  글을 읽고 주요 내용을 확인할 수 있다.',
  '세부 점검 요소': '- 글의 중요한 사실이나 정보를 이해하는가?<br>- 글의 내용을 간단히 자신의 말로 다시 말할 수 있는가?'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 중심 생각을 파악할 수 있다.',
  '세부 점검 요소': '- 문단이나 글 전체의 중심 문장을 찾을 수 있는가?<br>- 글에서 가장 중요한 생각을 자신의 말로 표현할 수 있는가?'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 주장이나 주제를 파악할 수 있다.',
  '세부 점검 요소': '- 글에서 말하려는 핵심 주장이나 주제를 찾는가?<br>- 글의 구체적인 내용과 주제 간의 관계를 설명할 수 있는가?'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  글의 구조를 고려하여 내용을 요약할 수 있다.',
  '세부 점검 요소': '- 글의 구조(예: 원인-결과, 문제-해결 등)를 구분할 수 있는가?<br>- 불필요한 표현을 줄이고 핵심만 간결하게 정리하는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  글을 읽고 인물의 모습, 처지나 마음을 짐작할 수 있다.',
  '세부 점검 요소': '- 인물의 행동·말·표정을 근거로 마음을 추측하는가?<br>- 상황에 맞는 인물의 처지를 말할 수 있는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신의 경험과 관련지어 글의 내용을 짐작할 수 있다.',
  '세부 점검 요소': '- 글의 상황과 자신의 경험을 연결하여 말하는가?<br>- 경험을 근거로 글의 의미를 확장해서 생각하는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 글쓴이의 마음이나 인물의 마음을 짐작할 수 있다.',
  '세부 점검 요소': '- 글쓴이의 표현에서 의도나 태도를 파악하는가?<br>- 인물의 말과 행동을 근거로 마음을 설명하는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  자신의 경험과 연관 지어 글에서 생략된 내용을 짐작할 수 있다.',
  '세부 점검 요소': '- 글에 직접 나오지 않은 내용을 상황에 맞게 보충하는가?<br>- 경험을 바탕으로 글의 공백을 메우는 설명을 하는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 인물의 성격, 행동, 동기 등을 추론할 수 있다.',
  '세부 점검 요소': '- 인물의 성격이나 동기를 행동과 대화에서 찾아내는가?<br>- 글의 단서와 배경지식을 활용하여 성격을 설명하는가?'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  배경지식과 경험을 활용하여 이어질 내용을 예측하고 생략된 내용을 추론할 수 있다.',
  '세부 점검 요소': '- 앞뒤 맥락을 근거로 이어질 사건을 예측하는가?<br>- 배경지식이나 경험을 활용해 생략된 부분을 추론하는가?'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 사실과 의견을 구분할 수 있다.',
  '세부 점검 요소': '- 글에서 사실과 의견을 구별하여 말할 수 있는가?<br>- 의견이 사실에 근거했는지 구별하는가?'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 내용의 타당성을 판단할 수 있다.',
  '세부 점검 요소': '- 주장이 근거에 의해 뒷받침되는지 확인하는가?<br>- 타당한 근거와 타당하지 않은 근거를 구별하는가?'},
 {'영역': '쓰기',
  '하위 요소': '글자 쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  글자를 바르게 쓸 수 있다.',
  '세부 점검 요소': '- 받침이 있는 글자를 정확히 쓸 수 있는가?<br>- 불러 주는 음절을 듣고 글자로 옮겨 쓸 수 있는가? '},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신이 하루 중 겪은 일과 관련된 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '- 하루 중 있었던 일을 기억해 글감으로 말할 수 있는가?<br>- 그 일을 글로 쓰기 알맞은 소재로 선택할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 소개할 대상을 떠올릴 수 있다.',
  '세부 점검 요소': '- 주변 인물·사물·장소 중 소개할 대상을 정할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  소개할 대상의 특징을 떠올릴 수 있다.',
  '세부 점검 요소': '- 소개 대상의 특징을 한두 가지 이상 구체적으로 말할 수 있는가?<br>- 특징이 드러나는 예를 함께 떠올릴 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  인상적인 경험에 대한 생각이나 느낌을 떠올릴 수 있다.',
  '세부 점검 요소': '- 경험한 일 중 가장 인상적인 순간을 떠올릴 수 있는가?<br>- 그때의 느낌이나 생각을 구체적으로 말할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에 일어난 일과 관련된 느낌(고마운 마음, 미안한 마음, 사과하는 마음)을 떠올릴 수 있다.',
  '세부 점검 요소': '- 특정 상황에서 느낀 감정을 떠올릴 수 있는가?<br>- 감정에 맞는 표현(고마움, 미안함 등)을 알맞게 사용할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일과 그 원인을 떠올릴 수 있다.',
  '세부 점검 요소': '- 사건이나 일을 구체적으로 떠올릴 수 있는가?<br>- 그 일이 일어난 까닭을 생각해 볼 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일과 관련된 의견을 떠올릴 수 있다.',
  '세부 점검 요소': '- 사건에 대해 자신의 의견을 말할 수 있는가?<br>- 그 의견의 까닭을 함께 떠올릴 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에 일어난 일과 관련된 느낌이나 생각을 떠올릴 수 있다.',
  '세부 점검 요소': '- 사건이나 상황에 대한 자신의 생각을 분명히 말할 수 있는가?<br>- 그 사건에서 느낀 감정을 구체적으로 표현할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에서 일어난 일과 그 원인을 떠올릴 수 있다.',
  '세부 점검 요소': '- 일어난 사건을 정확히 떠올릴 수 있는가?<br>- 사건의 원인과 결과를 연결해 생각할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  대상의 특성에 맞는 설명 방법(비교와 대조)에 따라 내용을 생성할 수 있다.',
  '세부 점검 요소': '- 대상을 다른 것과 비교하거나 대조해 특징을 떠올릴 수 있는가?<br>- 비교·대조를 통해 설명할 부분을 정리할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에서 일어난 일과 관련된 의견이나 관점, 근거를 떠올릴 수 있다.',
  '세부 점검 요소': '- 주제에 대해 자신의 관점을 분명히 말할 수 있는가?<br>- 관점을 뒷받침할 근거를 떠올릴 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주제와 관련된 자료(책, 인터넷, 신문 등)에서 내용을 조사하여 쓸 내용을 생성할 수 있다.',
  '세부 점검 요소': '- 주제와 관련된 자료를 찾아 쓸거리를 떠올릴 수 있는가?<br>- 조사한 자료에서 쓸 만한 내용을 골라낼 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신이 경험한 일을 나열할 수 있다.',
  '세부 점검 요소': '- 경험한 일을 빠뜨리지 않고 순서대로 말하거나 쓸 수 있는가?<br>- 사건을 한두 개 문장으로 간단히 나열할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 일어난 일을 나열할 수 있다.',
  '세부 점검 요소': '- 주변에서 있었던 일을 기억해 차례로 나열할 수 있는가?<br>- 사실과 관련 없는 내용을 덧붙이지 않고 정리하는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 일어난 일과 관련된 생각이나 느낌을 나열할 수 있다.',
  '세부 점검 요소': '- 사건과 관련된 자신의 생각이나 느낌을 말할 수 있는가?<br>- 여러 가지 느낌을 한 문장씩 나열할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  소개할 대상의 특성을 나열할 수 있다. ',
  '세부 점검 요소': '- 대상을 설명하는 특징을 두 가지 이상 나열할 수 있는가?<br>- 특징을 구체적인 낱말로 표현할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  경험한 일과 생각을 시간의 흐름에 따라 정리할 수 있다.',
  '세부 점검 요소': '- 경험을 처음·중간·끝의 순서대로 정리할 수 있는가?<br>- 사건과 그때의 생각을 연결해 말할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일을 시간의 흐름에 따라 정리할 수 있다.',
  '세부 점검 요소': '- 일어난 일을 시간 순서에 맞게 배열할 수 있는가?<br>- 불필요한 내용을 빼고 중요한 사건만 정리하는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  중심 내용과 세부 내용을 구분하여 정리할 수 있다.',
  '세부 점검 요소': '- 글의 핵심이 되는 중심 내용을 찾을 수 있는가?<br>- 중심 내용을 뒷받침하는 세부 사항을 구분할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일에 대한 의견과 그 까닭을 정리할 수 있다.',
  '세부 점검 요소': '- 사건에 대한 자신의 의견을 분명히 말할 수 있는가?<br>- 의견을 뒷받침하는 이유를 함께 정리할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  체험과 감상을 중심으로 쓸 내용을 조직할 수 있다.',
  '세부 점검 요소': '- 체험한 사실과 그에 대한 감상을 구분하여 정리할 수 있는가?<br>- 사실과 감상이 자연스럽게 연결되도록 내용을 구성하는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  대상의 특성에 알맞은 설명 방법(비교, 대조)에 따라 내용을 조직할 수 있다.',
  '세부 점검 요소': '- 비교·대조할 대상을 바르게 선택할 수 있는가?<br>- 공통점과 차이점을 나누어 정리할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  원인과 결과를 중심으로 쓸 내용을 조직할 수 있다.',
  '세부 점검 요소': '- 사건의 원인과 결과를 구분하여 말할 수 있는가?<br>- 원인과 결과가 자연스럽게 이어지도록 내용을 구성하는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  자신의 생각을 문장으로 표현할 수 있다.',
  '세부 점검 요소': '- 자신의 생각을 한 문장으로 바르게 쓸 수 있는가?<br>- 생각을 문장의 구조에 맞게 표현하는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  문장 부호를 사용하여 자신의 생각을 문장으로 정확하게 표현할 수 있다. ',
  '세부 점검 요소': '- 마침표·물음표·느낌표를 알맞게 사용하는가?<br>- 문장 부호가 문장의 의미와 맞게 쓰였는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  문장 부호를 사용하여 자신의 생각을 문장으로 정확하게 표현할 수 있다. ',
  '세부 점검 요소': '- 마침표·물음표·느낌표를 알맞게 사용하는가?<br>- 문장 부호가 문장의 의미와 맞게 쓰였는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  자신의 생각을 두세 문장으로 표현할 수 있다.',
  '세부 점검 요소': '- 관련 있는 두세 문장을 이어 쓸 수 있는가?<br>- 문장 간의 연결이 자연스러운가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  의미가 분명히 드러나도록 어울리지 않는 낱말을 적절하게 고쳐 쓸 수 있다. ',
  '세부 점검 요소': '- 문장에서 어울리지 않는 낱말을 찾아낼 수 있는가?<br>- 더 알맞은 낱말로 바꾸어 쓸 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  자신의 생각을 문단으로 표현할 수 있다. ',
  '세부 점검 요소': '- 문단 안에서 중심 문장을 분명히 쓸 수 있는가?<br>- 중심 문장을 뒷받침하는 세부 내용을 함께 쓸 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  문단의 내용 통일성을 고려하여 글을 쓸 수 있다.',
  '세부 점검 요소': '- 문단의 문장들이 한 가지 주제를 중심으로 이루어지는가?<br>- 주제와 관련 없는 문장을 배제할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  문단의 형식을 고려하여 글을 쓸 수 있다.',
  '세부 점검 요소': '- 문단의 시작·전개·마무리 구조를 갖추어 쓸 수 있는가?<br>- 글의 전체 흐름 속에서 문단을 배치할 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  매체를 활용하여 글을 쓸 수 있다.',
  '세부 점검 요소': '- 그림, 표, 사진 등 매체 자료를 적절히 활용할 수 있는가?<br>- 매체 자료가 글의 내용을 잘 뒷받침하는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  의미가 잘 드러나지 않는 문장을 적절하게 고쳐 쓸 수 있다.',
  '세부 점검 요소': '- 문장에서 모호한 표현을 찾아낼 수 있는가?<br>- 더 명확하게 고쳐 쓸 수 있는가?'},
 {'영역': '쓰기',
  '하위 요소': '표현하기·고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  격식에 맞지 않는 표현이나 부적절한 표현을 적절하게 고쳐 쓸 수 있다.',
  '세부 점검 요소': '- 상황에 맞지 않는 표현을 구별할 수 있는가?<br>- 문맥과 독자에 맞게 표현을 고쳐 쓸 수 있는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 이해',
  '학년군': '1~2',
  '점검 항목': '▪  낱말의 의미를 파악할 수 있다. ',
  '세부 점검 요소': '- 문장 속 낱말의 뜻을 바르게 말할 수 있는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 이해',
  '학년군': '3~4',
  '점검 항목': '▪  낱말의 의미를 파악할 수 있다. ',
  '세부 점검 요소': '- 문장 속 낱말의 뜻을 바르게 말할 수 있는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 이해',
  '학년군': '5~6',
  '점검 항목': '▪  낱말의 의미를 파악할 수 있다. ',
  '세부 점검 요소': '- 문장 속 낱말의 뜻을 바르게 말할 수 있는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 이해',
  '학년군': '3~4',
  '점검 항목': '▪  낱말의 의미를 짐작할 수 있다. ',
  '세부 점검 요소': '- 문맥이나 상황을 근거로 낱말의 뜻을 추측할 수 있는가?<br>- 짐작한 뜻이 글 전체 맥락과 어울리는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 이해',
  '학년군': '3~4',
  '점검 항목': '▪  어휘 사용의 적절성을 판단할 수 있다. ',
  '세부 점검 요소': '- 문장 속에서 낱말이 알맞게 쓰였는지 판단할 수 있는가?<br>- 어울리지 않는 낱말을 찾아 바꿀 수 있는가?'},
 {'영역': '어휘',
  '하위 요소': '어휘 표현',
  '학년군': '3~4',
  '점검 항목': '▪  쓰임에 맞게 낱말을 사용할 수 있다. ',
  '세부 점검 요소': '- 상황이나 맥락에 맞는 낱말을 선택하여 말하거나 쓸 수 있는가?<br>- 비슷한 의미의 낱말 중 더 알맞은 낱말을 골라 사용할 수 있는가?'}
];

function generateTable() {
    const tbody = document.getElementById('tableBody');
    const checkedGrades = Array.from(document.querySelectorAll('.gradeFilter:checked')).map(cb => cb.value);

    // Save previous states using key -> {selectedValue, reason}
    
    document.querySelectorAll("#tableBody tr").forEach(row => {
        const tds = row.querySelectorAll("td");
        if (tds.length < 4) return;
        const key = tds[0].innerText.trim() + "|" + tds[1].innerText.trim() + "|" + tds[2].innerText.trim() + "|" + tds[3].innerText.trim();
        let selectedValue = "";
        row.querySelectorAll("input[type='radio']").forEach(input => {
            if (input.checked) selectedValue = input.value;
        });
        const reasonInput = row.querySelector("input[type='text']");
        const reason = reasonInput ? reasonInput.value.trim() : "";
        previousStates[key] = { selectedValue, reason };
    });

    tbody.innerHTML = "";
    const filtered = data.filter(item => checkedGrades.includes(item['학년군']));
    filtered.forEach((item, idx) => {
        const tr = document.createElement('tr');
        const key = item['영역'] + "|" + item['하위 요소'] + "|" + item['학년군'] + "|" + item['점검 항목'];
        tr.innerHTML = `
<td>${item['영역']}</td>
<td>${item['하위 요소']}</td>
<td>${item['학년군']}</td>
<td style="text-align:left;">
  <div class="tooltip">
    ${item['점검 항목']}
    <span class="tooltiptext">${item['세부 점검 요소']}</span>
  </div>
</td>
<td><input type="radio" name="radio_${idx}" value="미도달"></td>
<td><input type="radio" name="radio_${idx}" value="도달"></td>
<td>
<div style="display: flex; align-items: center; gap: 4px; max-width: 500px;">
  <select style="flex: 0 0 100px; min-width: 50px;">
      <option value="">선택</option>
      <option value="① 이전 검사 결과 분석">① 이전 검사 결과 분석</option>
      <option value="② 신규 검사 시행">② 신규 검사 시행</option>
      <option value="③ 수행 과제 시행 및 관찰">③ 수행 과제 시행 및 관찰</option>
      <option value="④ 수업 중 관찰">④ 수업 중 관찰</option>
      <option value="⑤ 생활지도 중 관찰">⑤ 생활지도 중 관찰</option>
      <option value="⑥ 기타">⑥ 기타</option>
    </select>
    <input type="text" style="flex: 1 1 auto; min-width: 50;">
  </div>
</td>
`;
        tbody.appendChild(tr);

    });
    const rows = Array.from(document.querySelectorAll('#checklistTable tbody tr'));
    const visible = rows.map(row => row.style.display !== 'none');

    // Helper to get cell text
    function cellText(row, idx) {
        return row.children[idx].innerText.trim();
    }

    // mergeColumn 함수 정의
    function mergeColumn(colIdx, sameGroup) {
        let lastVisibleRow = null;
        let span = 1;

        rows.forEach((row, i) => {
            const currentCell = row.children[colIdx];
            currentCell.rowSpan = 1;
            currentCell.style.display = "";

            if (!lastVisibleRow) {
                lastVisibleRow = row;
                span = 1;
                return;
            }

            if (cellText(row, colIdx) === cellText(lastVisibleRow, colIdx) && sameGroup(row, i, lastVisibleRow)) {
                span++;
                currentCell.style.display = "none";
                lastVisibleRow.children[colIdx].rowSpan = span;
            } else {
                lastVisibleRow = row;
                span = 1;
            }
        });
    }

    // 영역(col0) 병합
    mergeColumn(0, ()=>true);
    // 하위요소(col1) 병합 – 같은 영역 내에서만
    mergeColumn(1, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0));
    // 학년(col2) 병합 – 같은 영역·하위요소 내에서만
    mergeColumn(2, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0) && cellText(row,1)===cellText(lastRow,1));

}

function resetFilter() {
    location.reload(); // 페이지를 새로고침하여 병합된 셀 구조 유지 및 입력값 완전 초기화
}

document.addEventListener('DOMContentLoaded', generateTable);


function exportExcel() {
    const wb = XLSX.utils.book_new();
    const ws_data = [["영역","하위 요소","학년군","점검 항목","미도달","도달","평정 근거"]];

    const rows = document.querySelectorAll("#tableBody tr");
    let currentArea = "";
    let currentGrade = "";

    rows.forEach(row => {
        if (row.style.display === "none") return;

        const tds = row.querySelectorAll("td");
        if (tds.length < 7) return;

        const areaText = tds[0].innerText.trim();
        if (areaText !== "") currentArea = areaText;

        const coreText = tds[1].innerText.trim();
        if (coreText !== "") currentCore = coreText;

        const gradeText = tds[2].innerText.trim();
        if (gradeText !== "") currentGrade = gradeText;

        const content = tds[3].innerText.trim();

        const levelIndicators = [];
        for (let i = 4; i <= 5; i++) {
            const input = tds[i].querySelector("input[type='radio']");
            levelIndicators.push(input && input.checked ? "V" : "");
        }

        const select = tds[6].querySelector("select");
        const reasonInput = tds[6].querySelector("input[type='text']");
        const reason = (select ? select.value : "") + ": " + (reasonInput ? reasonInput.value.trim() : "");

        ws_data.push([
            currentArea,
            currentCore,
            currentGrade,
            content,
            ...levelIndicators,
            reason
        ]);
    });

    const ws = XLSX.utils.aoa_to_sheet(ws_data);
    XLSX.utils.book_append_sheet(wb, ws, "문해력 향상 점검 도구");
    XLSX.writeFile(wb, "문해력_향상_점검_결과.xlsx");
}

</script>


<script>
// Enhancement for preserving radio/text inputs when applying filter

function saveCurrentState() {
    const states = {};
    document.querySelectorAll('#checklistTable tbody tr').forEach((row, index) => {
        const radios = row.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
            if (radio.checked) {
                states[`radio_${index}`] = radio.value;
            }
        });
        const select = row.querySelector('select');
        if (select) {
            states[`select_${index}`] = select.value;
        }
    });
    return states;
}

function restoreState(states) {
    document.querySelectorAll('#checklistTable tbody tr').forEach((row, index) => {
        const radios = row.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
            if (states[`radio_${index}`] && radio.value === states[`radio_${index}`]) {
                radio.checked = true;
            }
        });
        const select = row.querySelector('select');
        if (select && states[`select_${index}`] !== undefined) {
            select.value = states[`select_${index}`];
        }
    });
}

function applyFilter() {
    const previousStates = saveCurrentState();

    const selectedGrades = Array.from(document.querySelectorAll('.gradeFilter:checked')).map(cb => cb.value);

    const rows = Array.from(document.querySelectorAll('#checklistTable tbody tr'));

    // 필터 적용
    rows.forEach(row => {
        const grade = row.children[2].textContent.trim();
        if (selectedGrades.includes(grade)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });

    restoreState(previousStates);

    // 병합 전 초기화
    rows.forEach(row => {
        for (let cell of row.cells) {
            cell.rowSpan = 1;
            cell.style.display = "";
        }
    });

    // Helper
    function cellText(row, idx) {
        return row.children[idx].innerText.trim();
    }

    const visible = rows.map(row => row.style.display !== 'none');

    // 병합 함수
    function mergeColumn(colIdx, sameGroup) {
        let lastVisibleRow = null;
        let span = 1;

        rows.forEach((row, i) => {
            if (!visible[i]) return;

            const currentCell = row.children[colIdx];
            if (!lastVisibleRow) {
                lastVisibleRow = row;
                span = 1;
                return;
            }

            if (cellText(row, colIdx) === cellText(lastVisibleRow, colIdx) && sameGroup(row, i, lastVisibleRow)) {
                span++;
                currentCell.style.display = "none";
                lastVisibleRow.children[colIdx].rowSpan = span;
            } else {
                lastVisibleRow = row;
                span = 1;
            }
        });
    }

    // 영역(col0) 병합
    mergeColumn(0, ()=>true);
    // 하위요소(col1) 병합 – 같은 영역 내에서만
    mergeColumn(1, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0));
    // 학년(col2) 병합 – 같은 영역·하위요소 내에서만
    mergeColumn(2, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0) && cellText(row,1)===cellText(lastRow,1));

}
</script>

</body>

</html>
