
<!DOCTYPE html>
<html lang="ko">
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js">
</script>
<meta charset="UTF-8">
<title>문해력 향상 점검 도구</title>
<style>
.tooltip { position: relative; display: inline-block; cursor: help; }
.tooltip .tooltiptext { visibility: hidden; width: 400px; background: #f9f9f9; color: #000; border: 1px solid #ccc; padding: 8px; border-radius: 4px; position: absolute; z-index: 1; top: 100%; left: 0; white-space: pre-line; }
.tooltip:hover .tooltiptext { visibility: visible; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
th { background: #f2f2f2; }
.control-panel { margin: 10px 0; }
th:nth-child(1), td:nth-child(1),
th:nth-child(2), td:nth-child(2) {
  width: 80px;           /* 좁은 너비 */
  white-space: normal;   /* 줄바꿈 허용 */
  word-break: keep-all;  /* 단어 중간에서 줄바꿈 안 함 (띄어쓰기 기준으로만 줄바꿈) */
}
</style>
</head>
<body>
<h2>문해력 향상 점검 도구</h2>
<div class="control-panel">
학년군:
<label><input type="checkbox" class="gradeFilter" value="1~2" checked> 1~2학년군</label>
<label><input type="checkbox" class="gradeFilter" value="3~4" checked> 3~4학년군</label>
<label><input type="checkbox" class="gradeFilter" value="5~6" checked> 5~6학년군</label>
<button onclick="applyFilter()">적용</button>
<button onclick="resetFilter()">초기화</button>
</div>
<table id="checklistTable">
   <thead>
    <tr>
     <th colspan="1" rowspan="2">
      영역
     </th>
     <th colspan="1" rowspan="2">
      학년군
     </th>
     <th colspan="1" rowspan="2">
      하위 요소
     </th>
     <th colspan="1" rowspan="2">
      점검 항목
     </th>
     <th colspan="2" rowspan="1">
      도달 여부
     </th>
     <th colspan="1" rowspan="2">
      평정 근거
     </th>
     <th colspan="1" rowspan="2">
      보조 자료
     </th>
    </tr>
    <tr>
     <th>
      미도달
     </th>
     <th>
      도달
     </th>
    </tr>
   </thead><tbody id="tableBody">
</tbody>
</table>
<div style="margin-top:10px;">
<button onclick="exportExcel()">엑셀로 저장</button>
</div>
<script>
let previousStates = {};
const data = [
 {'영역': '듣기',
  '하위 요소': '소리 식별하기',
  '학년군': '1~2',
  '점검 항목': '▪  여러 가지 소리를 듣고 구별할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 들을 때 주의를 집중할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 대강의 내용을 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 상대의 기분이나 마음을 추측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 말이나 이야기의 대상이 무엇인지 추측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  안내하는 말/이야기를 듣고 주제를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  안내하는 말/이야기를 듣고 중요한 내용을 이해할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  안내하는 말/이야기를 듣고 중요한 내용을 간추릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 이어질 내용을 예측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 말하는 이의 의도를 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 자신의 생각과 비교할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 들으며 비언어적 표현을 확인할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말/설득하는 말/이야기를 듣고 주제를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말/설득하는 말/이야기를 듣고 중요한 내용을 이해할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말/설득하는 말/이야기를 듣고 중요한 내용을 요약할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 이어질 내용을 예측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 말하는 이의 의도를 추측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '내용 추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말/설득하는 말/이야기를 듣고 드러나지 않거나 생략된 내용을 추측할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  설득하는 말을 듣고 주장의 타당성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  설득하는 말을 듣고 근거의 적절성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말을 듣고 정보의 적절성을 판단할 수 있다',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 비언어적 표현의 효과를 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  설명하는 말/설득하는 말을 듣고 매체 자료의 효과를 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  상황이나 상대에 알맞은 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다. ',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '1~2',
  '점검 항목': '▪  적절한 표정, 몸짓, 말투로 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  목적이나 청자에 알맞은 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  일의 원인과 결과를 고려하여 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  비언어적･준언어적 표현을 활용하여 실감나게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '3~4',
  '점검 항목': '▪  전달하고자 하는 내용을 간결하게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  공식적･비공식적 상황에서 청자를 고려하여 적절한 말이나 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  일이 일어난 순서에 따라 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  일의 원인과 결과를 고려하여 말할 내용을 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  목적에 맞게 말할 내용을 체계적으로 구성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  여러 사람 앞에서 자신 있게 말할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  비언어적･준언어적 표현의 효과를 이해하고 그 특성을 살려 실감나게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  적절한 담화 표지를 사용하여 말할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '말하기',
  '하위 요소': '표현･전달하기',
  '학년군': '5~6',
  '점검 항목': '▪  매체를 활용하여 내용을 이해하기 쉽게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '1~2',
  '점검 항목': '▪  상대에게 반응하며 대화를 나눌 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '공감하기',
  '학년군': '1~2',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 듣는 이의 처지를 생각하며 칭찬, 사과의 말을 할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '3~4',
  '점검 항목': '▪  말차례를 지키며 대화를 나눌 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '3~4',
  '점검 항목': '▪  의견을 적극적으로 교환하며 회의할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '공감하기',
  '학년군': '3~4',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 듣는 이의 처지를 생각하며 부탁과 거절, 위로의 말을 할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '5~6',
  '점검 항목': '▪  말하기 방식의 차이를 고려하며 대화를 나눌 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '5~6',
  '점검 항목': '▪  의견을 제시하고 의견 불일치를 함께 조정하며 토의할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '상호 교섭하기',
  '학년군': '5~6',
  '점검 항목': '▪  토론의 절차와 규칙을 지키고 토론할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '듣기･말하기',
  '하위 요소': '공감하기',
  '학년군': '5~6',
  '점검 항목': '▪  다른 사람의 말/이야기를 듣고 상대가 처한 상황을 이해하고 공감할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '1~2',
  '점검 항목': '▪  글을 읽고 낱말의 의미를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '1~2',
  '점검 항목': '▪  글을 읽고 주요 내용을 확인할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  글자, 낱말을 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  문장, 문단, 글을 정확하게 소리 내어 읽을 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '해독･유창하게 읽기',
  '학년군': '1~2',
  '점검 항목': '▪  의미가 잘 드러나도록 글을 알맞게 띄어 읽을 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  글을 읽고 인물의 모습, 처지나 마음을 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신의 경험과 관련지어 글의 내용을 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 낱말의 의미를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 중심 생각을 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 대강의 내용을 간추릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 어휘 사용의 적절성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 사실과 의견을 구분할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  글에서 낱말의 의미를 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  글을 읽고 글쓴이의 마음이나 인물의 마음을 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '3~4',
  '점검 항목': '▪  자신의 경험과 연관지어 글에서 생략된 내용을 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 낱말의 의미를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 주장이나 주제를 파악할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '내용 확인하기',
  '학년군': '5~6',
  '점검 항목': '▪  글의 구조를 고려하여 내용을 요약할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 어휘 사용의 적절성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 표현의 적절성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 내용의 타당성을 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '비판･평가하기',
  '학년군': '5~6',
  '점검 항목': '▪  글이나 매체에 드러난 표현 방법의 효과를 판단할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  글에서 낱말의 의미를 짐작할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  글을 읽고 인물의 성격, 행동, 동기 등을 추론할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '읽기',
  '하위 요소': '추론하기',
  '학년군': '5~6',
  '점검 항목': '▪  배경지식과 경험을 활용하여 이어질 내용을 예측하고 생략된 내용을 추론할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신이 하루 중 겪은 일과 관련된 내용을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 소개할 대상을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '1~2',
  '점검 항목': '▪  소개할 대상의 특징을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  자신이 경험한 일을 나열할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 일어난 일을 나열할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  주변에서 일어난 일과 관련된 생각이나 느낌을 나열할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '1~2',
  '점검 항목': '▪  소개할 대상의 특성을 나열할 수 있다. ',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '글자 쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  글자를 바르게 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  자신의 생각을 문장으로 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '1~2',
  '점검 항목': '▪  문장 부호를 사용하여 자신의 생각을 문장으로 정확하게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  인상적인 경험에 대한 생각이나 느낌을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에 일어난 일과 관련된 느낌(고마운 마음, 미안한 마음, 사과하는 마음)을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일과 관련된 의견을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일과 그 원인을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  경험한 일과 생각을 시간의 흐름에 따라 정리할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일을 시간의 흐름에 따라 정리할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  중심 내용과 세부 내용을 구분하여 정리할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '3~4',
  '점검 항목': '▪  주변(가정, 학교)에서 일어난 일에 대한 의견과 그 까닭을 정리할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  문장 부호를 사용하여 자신의 생각을 문장으로 정확하게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  자신의 생각을 두세 문장으로 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '3~4',
  '점검 항목': '▪  의미가 분명히 드러나도록 어울리지 않는 낱말을 적절하게 고쳐 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  인상적인 경험에 대한 생각이나 느낌을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에서 일어난 일과 그 원인을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에 일어난 일과 관련된 느낌이나 생각을 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  대상의 특성에 맞는 설명 방법(비교와 대조)에 따라 내용을 생성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주변(가정, 학교, 사회)에서 일어난 일과 관련된 의견이나 관점, 근거를 떠올릴 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 생성하기',
  '학년군': '5~6',
  '점검 항목': '▪  주제와 관련된 자료(책, 인터넷, 신문 등)에서 내용을 조사하여 쓸 내용을 생성할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  체험과 감상을 중심으로 쓸 내용을 조직할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  대상의 특성에 알맞은 설명 방법(비교, 대조)에 따라 내용을 조직할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '내용 조직하기',
  '학년군': '5~6',
  '점검 항목': '▪  원인과 결과를 중심으로 쓸 내용을 조직할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  문장 부호를 사용하여 자신의 생각을 문장으로 정확하게 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  자신의 생각을 문단으로 표현할 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  문단의 내용 통일성을 고려하여 글을 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  문단의 형식을 고려하여 글을 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  매체를 활용하여 글을 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  의미가 잘 드러나지 않는 문장을 적절하게 고쳐 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'},
 {'영역': '쓰기',
  '하위 요소': '표현하기/고쳐쓰기',
  '학년군': '5~6',
  '점검 항목': '▪  격식에 맞지 않는 표현이나 부적절한 표현을 적절하게 고쳐 쓸 수 있다.',
  '세부 점검 요소': '점검 항목별 세부 점검 요소가 표시될 예정입니다.'}
];

function generateTable() {
    const tbody = document.getElementById('tableBody');
    const checkedGrades = Array.from(document.querySelectorAll('.gradeFilter:checked')).map(cb => cb.value);

    // Save previous states using key -> {selectedValue, reason}
    
    document.querySelectorAll("#tableBody tr").forEach(row => {
        const tds = row.querySelectorAll("td");
        if (tds.length < 4) return;
        const key = tds[0].innerText.trim() + "|" + tds[1].innerText.trim() + "|" + tds[2].innerText.trim() + "|" + tds[3].innerText.trim();
        let selectedValue = "";
        row.querySelectorAll("input[type='radio']").forEach(input => {
            if (input.checked) selectedValue = input.value;
        });
        const reasonInput = row.querySelector("input[type='text']");
        const reason = reasonInput ? reasonInput.value.trim() : "";
        previousStates[key] = { selectedValue, reason };
    });

    tbody.innerHTML = "";
    const filtered = data.filter(item => checkedGrades.includes(item['학년군']));
    filtered.forEach((item, idx) => {
        const tr = document.createElement('tr');
        const key = item['영역'] + "|" + item['학년군'] + "|" + item['하위 요소'] + "|" + item['점검 항목'];
        tr.innerHTML = `
<td>${item['영역']}</td>
<td>${item['학년군']}</td>
<td>${item['하위 요소']}</td>
<td style="text-align:left;">
  <div class="tooltip">
    ${item['점검 항목']}
    <span class="tooltiptext">${item['세부 점검 요소']}</span>
  </div>
</td>
<td><input type="radio" name="radio_${idx}" value="미도달"></td>
<td><input type="radio" name="radio_${idx}" value="도달"></td>
<td><input type="text" style="width:95%;"></td>
<td><button onclick="downloadResource()">&#x2B07;</button></td>
`;
        tbody.appendChild(tr);

    });
    const rows = Array.from(document.querySelectorAll('#checklistTable tbody tr'));
    const visible = rows.map(row => row.style.display !== 'none');

    // Helper to get cell text
    function cellText(row, idx) {
        return row.children[idx].innerText.trim();
    }

    // mergeColumn 함수 정의
    function mergeColumn(colIdx, sameGroup) {
        let lastVisibleRow = null;
        let span = 1;

        rows.forEach((row, i) => {
            const currentCell = row.children[colIdx];
            currentCell.rowSpan = 1;
            currentCell.style.display = "";

            if (!lastVisibleRow) {
                lastVisibleRow = row;
                span = 1;
                return;
            }

            if (cellText(row, colIdx) === cellText(lastVisibleRow, colIdx) && sameGroup(row, i, lastVisibleRow)) {
                span++;
                currentCell.style.display = "none";
                lastVisibleRow.children[colIdx].rowSpan = span;
            } else {
                lastVisibleRow = row;
                span = 1;
            }
        });
    }

    // 영역(col0) 병합
    mergeColumn(0, ()=>true);
    // 하위요소(col1) 병합 – 같은 영역 내에서만
    mergeColumn(1, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0));
    // 학년(col2) 병합 – 같은 영역·하위요소 내에서만
    mergeColumn(2, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0) && cellText(row,1)===cellText(lastRow,1));

}

function resetFilter() {
    location.reload(); // 페이지를 새로고침하여 병합된 셀 구조 유지 및 입력값 완전 초기화
}

document.addEventListener('DOMContentLoaded', generateTable);

function downloadResource() {
    alert('점검 항목에 대한 보조자료가 다운로드 되도록 할 예정입니다.');
}


function exportExcel() {
    const wb = XLSX.utils.book_new();
    const ws_data = [["영역","학년군","하위 요소","점검 항목","미도달","도달","평정 근거"]];

    const rows = document.querySelectorAll("#tableBody tr");
    let currentArea = "";
    let currentGrade = "";

    rows.forEach(row => {
        if (row.style.display === "none") return;

        const tds = row.querySelectorAll("td");
        if (tds.length < 8) return;

        const areaText = tds[0].innerText.trim();
        if (areaText !== "") currentArea = areaText;

        const gradeText = tds[1].innerText.trim();
        if (gradeText !== "") currentGrade = gradeText;

        const coreText = tds[2].innerText.trim();
        if (coreText !== "") currentCore = coreText;

        const content = tds[3].innerText.trim();

        const levelIndicators = [];
        for (let i = 4; i <= 5; i++) {
            const input = tds[i].querySelector("input[type='radio']");
            levelIndicators.push(input && input.checked ? "V" : "");
        }

        const reasonInput = tds[6].querySelector("input[type='text']");
        const reason = reasonInput ? reasonInput.value.trim() : "";

        ws_data.push([
            currentArea,
            currentGrade,
            currentCore,
            content,
            ...levelIndicators,
            reason
        ]);
    });

    const ws = XLSX.utils.aoa_to_sheet(ws_data);
    XLSX.utils.book_append_sheet(wb, ws, "문해력 향상 점검 도구");
    XLSX.writeFile(wb, "문해력_향상_점검_결과.xlsx");
}

</script>


<script>
// Enhancement for preserving radio/text inputs when applying filter

function saveCurrentState() {
    const states = {};
    document.querySelectorAll('#checklistTable tbody tr').forEach((row, index) => {
        const radios = row.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
            if (radio.checked) {
                states[`radio_${index}`] = radio.value;
            }
        });
        const textInput = row.querySelector('input[type="text"]');
        if (textInput) {
            states[`text_${index}`] = textInput.value;
        }
    });
    return states;
}

function restoreState(states) {
    document.querySelectorAll('#checklistTable tbody tr').forEach((row, index) => {
        const radios = row.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
            if (states[`radio_${index}`] && radio.value === states[`radio_${index}`]) {
                radio.checked = true;
            }
        });
        const textInput = row.querySelector('input[type="text"]');
        if (textInput && states[`text_${index}`] !== undefined) {
            textInput.value = states[`text_${index}`];
        }
    });
}

function applyFilter() {
    const previousStates = saveCurrentState();

    const selectedGrades = Array.from(document.querySelectorAll('.gradeFilter:checked')).map(cb => cb.value);

    const rows = Array.from(document.querySelectorAll('#checklistTable tbody tr'));

    // 필터 적용
    rows.forEach(row => {
        const grade = row.children[1].textContent.trim();
        if (selectedGrades.includes(grade)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });

    restoreState(previousStates);

    // 병합 전 초기화
    rows.forEach(row => {
        for (let cell of row.cells) {
            cell.rowSpan = 1;
            cell.style.display = "";
        }
    });

    // Helper
    function cellText(row, idx) {
        return row.children[idx].innerText.trim();
    }

    const visible = rows.map(row => row.style.display !== 'none');

    // 병합 함수
    function mergeColumn(colIdx, sameGroup) {
        let lastVisibleRow = null;
        let span = 1;

        rows.forEach((row, i) => {
            if (!visible[i]) return;

            const currentCell = row.children[colIdx];
            if (!lastVisibleRow) {
                lastVisibleRow = row;
                span = 1;
                return;
            }

            if (cellText(row, colIdx) === cellText(lastVisibleRow, colIdx) && sameGroup(row, i, lastVisibleRow)) {
                span++;
                currentCell.style.display = "none";
                lastVisibleRow.children[colIdx].rowSpan = span;
            } else {
                lastVisibleRow = row;
                span = 1;
            }
        });
    }

    // 영역(col0) 병합
    mergeColumn(0, ()=>true);
    // 하위요소(col1) 병합 – 같은 영역 내에서만
    mergeColumn(1, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0));
    // 학년(col2) 병합 – 같은 영역·하위요소 내에서만
    mergeColumn(2, (row,i,lastRow)=> cellText(row,0)===cellText(lastRow,0) && cellText(row,1)===cellText(lastRow,1));

}
</script>

</body>

</html>
